---
title: ExoPlayer Plugin
order: 2
---

## System requirements

1. Min Sdk version 14
2. Exoplayer version 2.9.6 or later

To integrate the SHls system, please follow these steps:

1. ExoPlayer integration version 2.9.6 or higher
2. Integrated SHls module
3. Initialize SHlsExoPlayer
4. Initialize SHlsMediaSource
5. Use the player after completion

#### ExoPlayer integration version 2.9.6 or higher

SHls is integrated as a module of ExoPlayer version 2.9.6 and above

Add Google and JCenter repositories to _build.gradle_

```xml
repositories {
    google()
    jcenter()
}
```

Add modules _ExoPlayer_

```java
implementation 'com.google.android.exoplayer:exoplayer:2.9.6'
implementation 'com.google.android.exoplayer:exoplayer-core:2.9.6'
implementation 'com.google.android.exoplayer:exoplayer-dash:2.9.6'
implementation 'com.google.android.exoplayer:exoplayer-ui:2.9.6'
implementation 'com.google.android.exoplayer:exoplayer-hls:2.9.6'
implementation 'com.google.android.exoplayer:exoplayer-smoothstreaming:2.9.6'
```

Enable Java 8 support

```java
compileOptions {
    sourceCompatibility JavaVersion.VERSION_1_8
    targetCompatibility JavaVersion.VERSION_1_8
}
```

#### Integrated SHls Module

Copy _library-shls-release.aar_ to the _app/libs_ directory, then add dependencies:

```java
implementation fileTree(dir: 'libs', include: ["*.aar"])
```

Initialize _SHlsExoPlayer_

```java
player = SHlsExoPlayerFactory.newSHlsInstance(
context, renderersFactory, trackSelector, drmSessionManager, bufferLength);
```

Initialize _SHlsMediaSource_

```java
SHlsPlaylistCallback shlsCallback = new SHlsPlaylistCallback() {
    @Override
    public void onLiveStreamPause() {
    	Show stream discontinued, most cases will be sent before the player switches buffer state
    }

    @Override
    public void onLiveStreamResume() {
    	reload source here
    }
};
mediaSource = SHlsMediaSourceFactory(dataSourceFactory)
            .setPlaylistParserFactory(
                new DefaultSHlsPlaylistParserFactory(shlsCallback))
            .createMediaSource(uri);
```

Initialize _trackselector_

<!-- import Alert from '@site/src/components/Alert'; -->

<!-- <Alert type="warning"> -->

SHlsTrackSelectionFactory\*\*\* can be used by default to replace _exoplayer_'s bandwidth meter for non-**ultralow-latency** streams. However, mandatory for ultralow-latency flows, it ensures automatic transfer of streams when network quality fluctuates

<!-- </Alert> -->

```java
SHlsTrackSelectionFactory adaptiveTrackSelectionFactory = new SHlsTrackSelectionFactory(1900);
adaptiveTrackSelectionFactory.setBufferProvider(
new SHlsTrackSelectionBufferProvider() {
    @Override
    public float getCurrent() {
        if (player != null)
        	return player.getTotalBufferedDuration() / 1000f;
        return 0;
    }

    @Override
    public float getPreferBuff() {
        if (player != null)
        	return ((SHlsExoPlayer) player).getTargetBufferTime();
        return -1f;
    }
});
trackSelector = new DefaultTrackSelector(adaptiveTrackSelectionFactory);
```

For details of the integration and use of ExoPlayer 2.9.6, please refer to: [Github ExoPlayer](https://github.com/google/ExoPlayer)
